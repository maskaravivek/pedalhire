{% extends 'base.html' %}
{% block content %}
<html>
    <head>
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
        <link rel="stylesheet" href="/static/css/cover.css">
        <title>PedalHire</title>
        <style>
            body {
                background-color: black;
                background-size: cover;
                -webkit-background-size: cover;
                -moz-background-size: cover;*/
            }

           * {
              box-sizing:border-box;
            }

            .row:after {
              content: "";
              display: table;
              clear: both;
            }

            .column-66 {
              float: left;
              width: 66.66666%;
              padding: 20px;
            }

            .column-33 {
              float: left;
              width: 33.33333%;
              padding: 20px;
            }

            .large-font {
              font-size: 24px;
            }

            .xlarge-font {
              font-size: 64px
            }

            .button {
              border: none;
              color: white;
              padding: 14px 28px;
              font-size: 16px;
              cursor: pointer;
              background-color: #4CAF50;
            }

            img {
              display: block;
              max-width: 100%;
              border: 10px  solid white;
              border-radius: 50%;
            }

            @media screen and (max-width: 1000px) {
              .column-66,
              .column-33 {
                width: 100%;
                text-align: center;
              }
              img {
                margin: auto;
              }
            }
        </style>
        <script>
            function purchaseProduct() {
            event.preventDefault();
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const startDateTime = urlParams.get('startDate')
            const endDateTime = urlParams.get('endDate')
            const url = "/api/v1/purchaseProduct";
            var id = $('#id-data').data();
            const data = {
                "id": id['name'],
                "startDateTime": startDateTime,
                "endDateTime": endDateTime
            };
            const other_params = {
                headers: { "content-type": "application/json; charset=UTF-8", "token": localStorage.getItem("auth_token") },
                body: JSON.stringify(data),
                method: "POST",
                mode: "cors"
            };

            fetch(url, other_params)
                .then(function (response) {
                    if (response.ok) {
                        return response;
                    } else {
                        throw new Error("Could not reach the API: " + response.statusText);
                    }
                }).then(function (data) {
                    window.alert("Successfully Booked");
                    window.location.replace("/");
                }).catch(function (error) {
                    console.log(error.message)
                });
            return true;
            }
        </script>
    </head>
    <body>
        {% for items in response %}
                <div style="margin-top:50px; margin-bottom:100px;" class="container">
                  <div class="row">
                    <div class="column-66">
                      <h1 class="xlarge-font"><b>{{ items['name'] }}</b></h1>
                      <h3 class="large-font" style="color:MediumSeaGreen;"><b>Distance : {{'%0.2f'| format(items['distance']|float)}}km</b></h3>
                      <h3>{{ items['description'] }}</h3>
                        <meta id="id-data" data-name="{{ items['id'] }}">
                      <button onclick="purchaseProduct()" class="button">Buy</button>
                    </div>
                    <div class="column-33">
                        {% if items['product_photo'] != '' %}
                            <img src={{ items['product_photo'] }} width="235" height="171">
                        {% else %}
                            <img src="/static/img/no_img.png" width="235" height="171">
                        {% endif %}
                    </div>
                  </div>
                </div>
        {% endfor %}
    </body>
</html>
{% endblock %}